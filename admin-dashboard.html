<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Crown Trade Academy</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Role-based access styles */
        .role-section {
            display: none;
        }
        
        .role-admin .admin-section,
        .role-finance .finance-section, 
        .role-support .support-section,
        .role-mentor .mentor-section {
            display: block;
        }

        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .action-card {
            background: var(--off-white);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--light-taupe);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .action-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(58, 45, 40, 0.1);
        }

        .action-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .pending-badge {
            background: #E67E22;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
    </style>
</head>
<body class="role-admin">
    <!-- Luxury Header -->
    <header class="premium-header luxury-nav">
        <nav class="premium-nav">
            <a href="index.html" class="logo" style="display: flex; align-items: center;">
                <span class="crown-icon">üëë</span>
                Crown Trade Academy
            </a>
            <div style="display: flex; align-items: center; gap: 2rem;">
                <span style="color: var(--gold-accent); font-weight: 700; font-size: 1.1rem;" id="roleDisplay">Admin Command Center</span>
                <ul class="nav-links">
                    <li><a href="admin-dashboard.html" style="color: var(--gold-accent); font-weight: 600;">Dashboard</a></li>
                    <li><a href="admin-payment-settings.html">Payment Settings</a></li>
                    <li><a href="admin-referral-approvals.html">Referral Approvals</a></li>
                    <li><a href="admin-withdrawal-approvals.html">Withdrawal Approvals</a></li>
                    <li><span class="admin-badge-luxury" id="adminName">Administrator</span></li>
                    <li><a href="#" onclick="logoutAdmin()" style="color: var(--warm-beige);"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Role-Based Dashboard Content -->
    <section class="premium-container" style="padding: 2rem 0;">
        
        <!-- ADMIN ROLE CONTENT -->
        <div class="role-section admin-section">
            <div class="luxury-card" style="background: linear-gradient(135deg, var(--muted-rose), var(--warm-beige)); color: var(--dark-brown);">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
                    <div style="flex: 1;">
                        <h1 style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 800;">
                            <span class="crown-icon">üëë</span> Admin Command Center
                        </h1>
                        <p style="font-size: 1.2rem; font-weight: 600; color: var(--dark-brown); opacity: 0.9;">
                            Full System Control ‚Ä¢ Real-time Analytics ‚Ä¢ Complete Oversight
                        </p>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1rem; color: var(--dark-brown); opacity: 0.8;">Super Admin</div>
                        <div style="font-size: 1.3rem; font-weight: 800; color: var(--dark-brown);" id="adminWelcome">Administrator</div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions - ADMIN -->
            <div class="quick-actions-grid">
                <div class="action-card" onclick="showReferralApprovals()">
                    <div class="action-icon">üë•</div>
                    <h4>Referral Approvals</h4>
                    <p>Review new applications</p>
                    <span class="pending-badge" id="pendingReferralsCount">0</span>
                </div>
                
                <div class="action-card" onclick="showWithdrawalApprovals()">
                    <div class="action-icon">üí∏</div>
                    <h4>Withdrawal Requests</h4>
                    <p>Process payments</p>
                    <span class="pending-badge" id="pendingWithdrawalsCount">0</span>
                </div>
                
                <div class="action-card" onclick="showClientManagement()">
                    <div class="action-icon">üìä</div>
                    <h4>Client Management</h4>
                    <p>View all clients</p>
                </div>
                
                <div class="action-card" onclick="openPaymentSettings()">
                    <div class="action-icon">‚öôÔ∏è</div>
                    <h4>System Settings</h4>
                    <p>Configure payments</p>
                </div>
                
                <div class="action-card" onclick="generateReports()">
                    <div class="action-icon">üìà</div>
                    <h4>Generate Reports</h4>
                    <p>Financial analytics</p>
                </div>
                
                <div class="action-card" onclick="manageTeam()">
                    <div class="action-icon">üë®‚Äçüíº</div>
                    <h4>Team Management</h4>
                    <p>Staff accounts</p>
                </div>
            </div>
        </div>

        <!-- FINANCE ROLE CONTENT -->
        <div class="role-section finance-section">
            <div class="luxury-card" style="background: linear-gradient(135deg, #27AE60, #2ECC71); color: white;">
                <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">
                    <i class="fas fa-chart-line"></i> Finance Dashboard
                </h1>
                <p style="font-size: 1.2rem;">Payment Processing ‚Ä¢ Financial Reports ‚Ä¢ Revenue Tracking</p>
            </div>

            <!-- Quick Actions - FINANCE -->
            <div class="quick-actions-grid">
                <div class="action-card" onclick="processWithdrawals()">
                    <div class="action-icon">üí≥</div>
                    <h4>Process Withdrawals</h4>
                    <p>Send payments to clients</p>
                </div>
                
                <div class="action-card" onclick="viewRevenue()">
                    <div class="action-icon">üí∞</div>
                    <h4>Revenue Report</h4>
                    <p>Income analytics</p>
                </div>
                
                <div class="action-card" onclick="paymentRecords()">
                    <div class="action-icon">üìã</div>
                    <h4>Payment Records</h4>
                    <p>All transactions</p>
                </div>
            </div>
        </div>

        <!-- SUPPORT ROLE CONTENT -->
        <div class="role-section support-section">
            <div class="luxury-card" style="background: linear-gradient(135deg, #3498DB, #2980B9); color: white;">
                <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">
                    <i class="fas fa-headset"></i> Support Dashboard
                </h1>
                <p style="font-size: 1.2rem;">Client Support ‚Ä¢ Issue Resolution ‚Ä¢ Account Management</p>
            </div>

            <!-- Quick Actions - SUPPORT -->
            <div class="quick-actions-grid">
                <div class="action-card" onclick="viewClientIssues()">
                    <div class="action-icon">üé´</div>
                    <h4>Support Tickets</h4>
                    <p>Client issues</p>
                </div>
                
                <div class="action-card" onclick="manageAccounts()">
                    <div class="action-icon">üë•</div>
                    <h4>Client Accounts</h4>
                    <p>Manage users</p>
                </div>
                
                <div class="action-card" onclick="approveReferrals()">
                    <div class="action-icon">‚úÖ</div>
                    <h4>Approve Referrals</h4>
                    <p>Review applications</p>
                </div>
            </div>
        </div>

        <!-- Luxury Stats Grid -->
        <div class="luxury-stats">
            <div class="luxury-stat fade-in-up">
                <div class="luxury-stat-icon">üë•</div>
                <div class="luxury-stat-number" id="totalClients">0</div>
                <div class="luxury-stat-label">Total Clients</div>
            </div>
            
            <div class="luxury-stat fade-in-up">
                <div class="luxury-stat-icon">üí∞</div>
                <div class="luxury-stat-number">KES <span id="totalRevenue">0</span></div>
                <div class="luxury-stat-label">Total Revenue</div>
            </div>
            
            <div class="luxury-stat fade-in-up">
                <div class="luxury-stat-icon">‚è≥</div>
                <div class="luxury-stat-number" id="pendingWithdrawals">0</div>
                <div class="luxury-stat-label">Pending Withdrawals</div>
            </div>
            
            <div class="luxury-stat fade-in-up">
                <div class="luxury-stat-icon">üìà</div>
                <div class="luxury-stat-number" id="pendingReferrals">0</div>
                <div class="luxury-stat-label">Pending Referrals</div>
            </div>
        </div>
    </section>

    <!-- Recent Activity -->
    <section class="premium-container">
        <div class="luxury-card fade-in-up">
            <h2 style="margin-bottom: 2rem; color: var(--dark-brown); font-size: 1.8rem; font-weight: 800;">
                <i class="fas fa-history"></i> Recent Activity
            </h2>
            
            <table class="luxury-table">
                <thead>
                    <tr>
                        <th>Client</th>
                        <th>Activity</th>
                        <th>Time</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="recentActivity">
                    <!-- Activity will be loaded here -->
                </tbody>
            </table>
        </div>
    </section>

    <script>
        // Admin authentication check
        if (localStorage.getItem('adminLoggedIn') !== 'true') {
            window.location.href = 'admin-login.html';
        }

        // Set user role and display
        document.addEventListener('DOMContentLoaded', function() {
            const adminRole = localStorage.getItem('adminRole') || 'admin';
            const adminName = localStorage.getItem('adminName') || 'Administrator';
            
            // Set body class for role-based styling
            document.body.className = 'role-' + adminRole;
            
            // Update display
            document.getElementById('adminName').textContent = adminName;
            document.getElementById('adminWelcome').textContent = adminName;
            
            // Update role display
            const roleDisplays = {
                'admin': 'Admin Command Center',
                'finance': 'Finance Dashboard', 
                'support': 'Support Center',
                'mentor': 'Mentor Portal'
            };
            document.getElementById('roleDisplay').textContent = roleDisplays[adminRole] || 'Admin Panel';

            // Load dashboard data
            loadDashboardData();
        });

        function loadDashboardData() {
            // Load referral applications
            const pendingApplications = JSON.parse(localStorage.getItem('pendingReferralApplications') || '[]');
            document.getElementById('pendingReferrals').textContent = pendingApplications.length;
            document.getElementById('pendingReferralsCount').textContent = pendingApplications.length;

            // Load withdrawal requests  
            const withdrawalRequests = JSON.parse(localStorage.getItem('withdrawalRequests') || '[]');
            const pendingWithdrawals = withdrawalRequests.filter(w => w.status === 'pending');
            document.getElementById('pendingWithdrawals').textContent = pendingWithdrawals.length;
            document.getElementById('pendingWithdrawalsCount').textContent = pendingWithdrawals.length;

            // Load client count
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            document.getElementById('totalClients').textContent = users.length;

            // Calculate revenue (simplified)
            const revenue = users.length * 500; // Base calculation
            document.getElementById('totalRevenue').textContent = revenue.toLocaleString();

            // Load recent activity
            loadRecentActivity();
        }

        function loadRecentActivity() {
            const activityTable = document.getElementById('recentActivity');
            const pendingApplications = JSON.parse(localStorage.getItem('pendingReferralApplications') || '[]');
            
            if (pendingApplications.length === 0) {
                activityTable.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; color: var(--muted-rose); padding: 2rem;">
                            No recent activity
                        </td>
                    </tr>
                `;
                return;
            }

            // Show latest 5 applications
            const recentApps = pendingApplications.slice(-5).reverse();
            activityTable.innerHTML = recentApps.map(app => `
                <tr>
                    <td style="font-weight: 600; color: var(--dark-brown);">${app.userData.fullName}</td>
                    <td style="color: var(--muted-rose);">Applied for Referral Program</td>
                    <td style="color: var(--muted-rose);">${new Date(app.submissionDate).toLocaleDateString()}</td>
                    <td><span class="status-badge status-pending">Pending</span></td>
                </tr>
            `).join('');
        }

        // Navigation functions
        function showReferralApprovals() {
            window.location.href = 'admin-referral-approvals.html';
        }

        function showWithdrawalApprovals() {
            window.location.href = 'admin-withdrawal-approvals.html';
        }

        function logoutAdmin() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminRole');
            localStorage.removeItem('adminName');
            window.location.href = 'admin-login.html';
        }
    </script>
</body>
</html>
