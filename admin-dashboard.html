<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Crown Trade Academy</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Your existing admin dashboard styles remain the same */
        /* ... existing CSS code ... */
    </style>
</head>
<body>
    <!-- Premium Header -->
    <header class="premium-header">
        <nav class="premium-nav">
            <a href="index.html" class="logo">Crown Trade Academy</a>
            <div style="display: flex; align-items: center; gap: 2rem;">
                <span style="color: var(--gold); font-weight: 600;">Admin Dashboard</span>
                <ul class="nav-links">
                    <li><a href="admin-dashboard.html" style="color: var(--gold);">Dashboard</a></li>
                    <li><a href="admin-payment-settings.html">Payment Settings</a></li>
                    <li><a href="admin-referral-approvals.html">Referral Approvals</a></li>
                    <li><a href="admin-withdrawal-approvals.html">Withdrawal Approvals</a></li>
                    <li><span class="admin-badge" id="adminName">Administrator</span></li>
                    <li><a href="#" onclick="logoutAdmin()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Admin Hero -->
    <section class="admin-container" style="padding: 2rem 0;">
        <div class="admin-card" style="background: linear-gradient(135deg, var(--nude-dark), #4A3A32); color: white;">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
                <div>
                    <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem;">
                        <i class="fas fa-crown"></i> Admin Command Center
                    </h1>
                    <p style="color: var(--nude-light); font-size: 1.1rem;">Manage clients, payments, and platform operations</p>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 0.9rem; color: var(--nude-light);">Logged in as</div>
                    <div style="font-size: 1.2rem; font-weight: 700; color: var(--gold);" id="adminWelcome">Administrator</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="admin-container">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-number" id="totalClients">47</div>
                <div class="stat-label">Total Clients</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                <div class="stat-number">KES <span id="totalRevenue">128,500</span></div>
                <div class="stat-label">Total Revenue</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-clock"></i></div>
                <div class="stat-number" id="pendingWithdrawals">3</div>
                <div class="stat-label">Pending Withdrawals</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                <div class="stat-number" id="pendingReferrals">5</div>
                <div class="stat-label">Pending Referrals</div>
            </div>
        </div>
    </section>

    <!-- Main Admin Content -->
    <section class="admin-container">
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
            
            <!-- Left Column - Management -->
            <div>
                <!-- Quick Actions -->
                <div class="admin-card">
                    <h2 style="margin-bottom: 1.5rem; color: var(--nude-dark);">
                        <i class="fas fa-bolt"></i> Quick Actions
                    </h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <button class="btn-admin" onclick="showWithdrawals()">
                            <i class="fas fa-money-bill-wave"></i> Process Withdrawals
                        </button>
                        <button class="btn-admin" onclick="showClientManagement()">
                            <i class="fas fa-users"></i> Manage Clients
                        </button>
                        <button class="btn-admin" onclick="showReferralApprovals()">
                            <i class="fas fa-user-check"></i> Referral Approvals
                        </button>
                        <button class="btn-admin" onclick="showPaymentRecords()">
                            <i class="fas fa-credit-card"></i> Payment Records
                        </button>
                        <button class="btn-admin" onclick="generateReport()">
                            <i class="fas fa-chart-bar"></i> Generate Report
                        </button>
                    </div>
                </div>

                <!-- Your existing content remains the same -->
                <!-- Pending Withdrawals Section -->
                <div class="admin-card" id="withdrawalsSection">
                    <!-- ... existing withdrawals content ... -->
                </div>

                <!-- Recent Client Activity -->
                <div class="admin-card">
                    <!-- ... existing activity content ... -->
                </div>
            </div>

            <!-- Right Column - Team & System -->
            <div>
                <!-- Team Management -->
                <div class="admin-card">
                    <!-- ... existing team content ... -->
                </div>

                <!-- System Status -->
                <div class="admin-card">
                    <!-- ... existing system status ... -->
                </div>

                <!-- Quick Tools -->
                <div class="admin-card">
                    <h3 style="margin-bottom: 1rem; color: var(--nude-dark);">
                        <i class="fas fa-tools"></i> Quick Tools
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <button class="btn-admin" onclick="openPaymentSettings()">
                            <i class="fas fa-cog"></i> Payment Settings
                        </button>
                        <button class="btn-admin btn-success" onclick="generateReport()">
                            <i class="fas fa-chart-bar"></i> Generate Report
                        </button>
                        <button class="btn-admin btn-warning" onclick="backupSystem()">
                            <i class="fas fa-database"></i> Backup System
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Your existing modals and footer remain the same -->
    <!-- MODALS -->
    <!-- Client Management Modal -->
    <div id="clientManagementModal" class="modal">
        <!-- ... existing modal content ... -->
    </div>

    <!-- Team Management Modal -->
    <div id="teamManagementModal" class="modal">
        <!-- ... existing modal content ... -->
    </div>

    <!-- Payment Records Modal -->
    <div id="paymentRecordsModal" class="modal">
        <!-- ... existing modal content ... -->
    </div>

    <!-- Admin Footer -->
    <footer class="admin-footer">
        <div class="footer-content">
            <div>
                <h3>Admin System</h3>
                <p>Team Management Portal</p>
                <p>Email: crowntradeacademy@gmail.com</p>
            </div>
            <div>
                <h3>Quick Access</h3>
                <p><a href="admin-payment-settings.html" style="color: var(--nude-light); text-decoration: none;">Payment Settings</a></p>
                <p><a href="admin-referral-approvals.html" style="color: var(--nude-light); text-decoration: none;">Referral Approvals</a></p>
                <p><a href="admin-withdrawal-approvals.html" style="color: var(--nude-light); text-decoration: none;">Withdrawal Approvals</a></p>
            </div>
            <div>
                <h3>System</h3>
                <p><span id="onlineTeam">3</span> Team Members Online</p>
                <p><span id="totalClientsFooter">47</span> Active Clients</p>
                <p>All Systems Operational</p>
            </div>
        </div>
        <div style="text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--nude-medium);">
            <p style="color: var(--nude-light);">&copy; 2024 Crown Trade Academy. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Admin authentication check
        if (localStorage.getItem('adminLoggedIn') !== 'true') {
            window.location.href = 'admin-login.html';
        }

        // Initialize Admin Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadAdminData();
            updateAdminWelcome();
            loadWithdrawals();
            loadRecentActivity();
            updatePendingReferrals();
        });

        function updateAdminWelcome() {
            const adminName = localStorage.getItem('adminName') || 'Administrator';
            document.getElementById('adminWelcome').textContent = adminName;
            document.getElementById('adminName').textContent = adminName;
        }

        function loadAdminData() {
            // Simulate loading real data
            const totalClients = Math.floor(Math.random() * 100) + 30;
            const totalRevenue = (totalClients * 27500).toLocaleString();
            const activeReferrals = Math.floor(totalClients * 0.7);
            
            document.getElementById('totalClients').textContent = totalClients;
            document.getElementById('totalRevenue').textContent = totalRevenue;
            document.getElementById('activeReferrals').textContent = activeReferrals;
            document.getElementById('totalClientsFooter').textContent = totalClients;
        }

        // NEW FUNCTION: Update pending referrals count
        function updatePendingReferrals() {
            const pendingApprovals = JSON.parse(localStorage.getItem('pendingApprovals') || '[]');
            document.getElementById('pendingReferrals').textContent = pendingApprovals.length;
        }

        // NEW FUNCTION: Show referral approvals
        function showReferralApprovals() {
            window.location.href = 'admin-referral-approvals.html';
        }

        // Your existing functions remain the same
        function showWithdrawals() {
            document.getElementById('withdrawalsSection').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
            alert('ðŸ“‹ Scrolled to Pending Withdrawals section!');
        }

        function showClientManagement() {
            const modal = document.getElementById('clientManagementModal');
            const content = document.getElementById('clientManagementContent');
            
            content.innerHTML = `
                <div style="margin-bottom: 1.5rem;">
                    <h3 style="color: var(--nude-dark); margin-bottom: 1rem;">Client List</h3>
                    <div style="background: var(--nude-cream); padding: 1rem; border-radius: 8px;">
                        <p><strong>Total Clients:</strong> 47</p>
                        <p><strong>Active Today:</strong> 12</p>
                        <p><strong>New This Week:</strong> 8</p>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <button class="btn-admin" onclick="viewAllClients()">
                        <i class="fas fa-list"></i> View All Clients
                    </button>
                    <button class="btn-admin btn-success" onclick="addNewClient()">
                        <i class="fas fa-user-plus"></i> Add Client
                    </button>
                    <button class="btn-admin btn-warning" onclick="exportClientData()">
                        <i class="fas fa-download"></i> Export Data
                    </button>
                    <button class="btn-admin btn-danger" onclick="bulkActions()">
                        <i class="fas fa-cog"></i> Bulk Actions
                    </button>
                </div>
            `;
            
            modal.style.display = 'flex';
        }

        function showPaymentRecords() {
            const modal = document.getElementById('paymentRecordsModal');
            const content = document.getElementById('paymentRecordsContent');
            
            content.innerHTML = `
                <div style="margin-bottom: 1.5rem;">
                    <h3 style="color: var(--nude-dark); margin-bottom: 1rem;">Payment Records</h3>
                    <div style="background: var(--nude-cream); padding: 1rem; border-radius: 8px;">
                        <p><strong>Total Revenue:</strong> KES 128,500</p>
                        <p><strong>This Month:</strong> KES 45,200</p>
                        <p><strong>Pending:</strong> KES 12,800</p>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <button class="btn-admin" onclick="viewAllPayments()">
                        <i class="fas fa-list"></i> View Payments
                    </button>
                    <button class="btn-admin btn-success" onclick="processPayments()">
                        <i class="fas fa-cog"></i> Process Batch
                    </button>
                    <button class="btn-admin btn-warning" onclick="exportPaymentData()">
                        <i class="fas fa-download"></i> Export Records
                    </button>
                    <button class="btn-admin btn-danger" onclick="paymentAnalytics()">
                        <i class="fas fa-chart-bar"></i> Analytics
                    </button>
                </div>
            `;
            
            modal.style.display = 'flex';
        }

        function openPaymentSettings() {
            window.location.href = 'admin-payment-settings.html';
        }

        // Your existing modal, withdrawal, and utility functions remain the same
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function logoutAdmin() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminName');
                localStorage.removeItem('adminRole');
                window.location.href = 'index.html';
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
        }
    </script>
</body>
</html>
